/* eslint-disable no-inner-declarations */

try {
    // listen for custom event to build slots
    document.addEventListener('BcFirstImpressionUnfilled', function (event) {
        const slot = event.detail;
        if (['snopes_outstream', 'snopes_outstream_mobile'].includes(slot.name)) {
            slot.disableRefresh();
            injectStickySlot();
        }
    });

    function injectStickySlot() {
        // if window width is less than 768px
        if(window.innerWidth < 768) {
            // Create the outer div element
            const outerDiv = document.createElement("div");
            outerDiv.id = "outer_sticky";
            outerDiv.style.display = "none";

            // Create the close div element
            const closeDiv = document.createElement("div");
            closeDiv.id = "close_sticky";
            closeDiv.setAttribute("onclick", "ads_project.close_sticky(); return false;");
            closeDiv.innerHTML = `<svg class="x_close_logo" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
        <path fill="currentColor" d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 
        105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 
        45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
        </svg>`;

            // Create the inner div element
            const innerDiv = document.createElement("div");
            innerDiv.id = "sticky_ad_container";
            innerDiv.className = "htlad-snopes_m_sticky";
            innerDiv.setAttribute("data-targeting", '{"sticky_refresh": "01"}');

            // Append the close div and inner div to the outer div
            outerDiv.appendChild(closeDiv);
            outerDiv.appendChild(innerDiv);

            // Get a reference to the body element
            const body = document.getElementsByTagName("body")[0];

            // Insert the outer div as the first child of the body
            body.insertBefore(outerDiv, body.firstChild);
        } else {
            // Create the outer div element
            const outerDiv = document.createElement("div");
            outerDiv.id = "outer_sticky";
            outerDiv.style.display = "none";

            // Create the close div element
            const closeDiv = document.createElement("div");
            closeDiv.id = "close_sticky";
            closeDiv.setAttribute("onclick", "ads_project.close_sticky(); return false;");
            closeDiv.innerHTML = `<svg class="x_close_logo" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
        <path fill="currentColor" d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 
        105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 
        45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
        </svg>`;

            // Create the inner div element
            const innerDiv = document.createElement("div");
            innerDiv.id = "sticky_ad_container";
            innerDiv.className = "htlad-snopes_dt_sticky";
            innerDiv.setAttribute("data-targeting", '{"sticky_refresh": "01"}');

            // Append the close div and inner div to the outer div
            outerDiv.appendChild(closeDiv);
            outerDiv.appendChild(innerDiv);

            // Get a reference to the body element
            const body = document.getElementsByTagName("body")[0];

            // Insert the outer div as the first child of the body
            body.insertBefore(outerDiv, body.firstChild);
        }
    }

} catch(e) {
    console.error(e);
}